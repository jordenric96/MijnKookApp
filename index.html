<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KookApp van Loemek</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* 1. GLOBALE STYLING & FUNKY GRADIENT */
        body { 
            font-family: 'Poppins', sans-serif; 
            background: linear-gradient(135deg, #fce7f3 0%, #f5f3ff 100%) no-repeat fixed;
            margin: 0; padding: 0; color: #374151; min-height: 100vh;
        }

        /* 2. FUNKY ROZE-PAARSE HEADER */
        header { 
            background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%); 
            color: white; 
            padding: 50px 20px; 
            text-align: center; 
            border-radius: 0 0 40px 40px;
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.3);
        }
        
        header h1 { 
            font-family: 'Playfair Display', serif; 
            font-size: 45px; margin: 0; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        /* 3. ZOEKBALK EN FILTERS */
        .controls-container {
            max-width: 800px;
            margin: -30px auto 30px;
            padding: 0 20px;
        }

        #searchInput {
            width: 100%; padding: 18px 25px; border-radius: 35px; border: none; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); outline: none; font-size: 16px;
            box-sizing: border-box; transition: 0.3s;
        }

        #searchInput:focus { transform: scale(1.02); }

        .filter-tabs {
            display: flex; justify-content: center; gap: 10px; 
            margin-top: 20px; flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 20px; border-radius: 25px; border: none;
            background: white; color: #8b5cf6; font-weight: 600;
            cursor: pointer; transition: 0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .filter-btn.active {
            background: #ec4899; color: white; transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(236, 72, 153, 0.3);
        }

        /* 4. RECEPTEN KAARTJES */
        .recipe-grid { 
            display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
            gap: 30px; max-width: 1200px; margin: 40px auto; padding: 0 20px;
        }

        .recipe-card { 
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px);
            border-radius: 30px; overflow: hidden; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.05); transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            text-decoration: none; color: inherit; position: relative;
            display: flex; flex-direction: column;
        }

        .recipe-card:hover { transform: translateY(-12px); box-shadow: 0 20px 40px rgba(139, 92, 246, 0.2); }

        .card-img { width: 100%; height: 220px; object-fit: cover; }
        
        .card-content { padding: 25px; flex-grow: 1; }
        .card-title { font-family: 'Playfair Display', serif; font-size: 24px; margin: 0; color: #1f2937; }
        .card-chef { font-size: 14px; color: #ec4899; font-weight: 600; margin-top: 8px; }

        .card-emoji {
            position: absolute; right: 20px; top: 185px; font-size: 35px;
            background: white; border-radius: 50%; width: 55px; height: 55px;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* 5. SCORE BALK */
        .score-bar-container { height: 10px; width: 100%; background: #eee; }
        .score-bar-fill { height: 100%; transition: width 1s ease-in-out; }

        .add-btn { 
            position: fixed; bottom: 30px; right: 30px; 
            background: linear-gradient(135deg, #ec4899, #8b5cf6);
            color: white; width: 70px; height: 70px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 40px; text-decoration: none; box-shadow: 0 10px 30px rgba(236, 72, 153, 0.5);
            z-index: 100; transition: 0.3s;
        }
        .add-btn:hover { transform: scale(1.1) rotate(90deg); }
    </style>
</head>
<body>

<header>
    <h1>KookApp van Loemek</h1>
</header>

<div class="controls-container">
    <input type="text" id="searchInput" placeholder="Zoek op smaak, ingredi√´nt of chef..." onkeyup="filterContent()">
    
    <div class="filter-tabs" id="filterTabs">
        <button class="filter-btn active" onclick="setFilter('All', this)">Alles ü•ò</button>
        <button class="filter-btn" onclick="setFilter('Voorgerecht', this)">Voorgerecht</button>
        <button class="filter-btn" onclick="setFilter('Hoofdgerecht', this)">Hoofdgerecht</button>
        <button class="filter-btn" onclick="setFilter('Dessert', this)">Dessert</button>
        <button class="filter-btn" onclick="setFilter('Patisserie', this)">Patisserie</button>
        <button class="filter-btn" onclick="setFilter('Snack', this)">Snack</button>
    </div>
</div>

<div class="recipe-grid" id="recipeGrid"></div>

<a href="toevoegen.html" class="add-btn">+</a>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBzsxSTQKhhh8yKb4AFew7zQz26BMNKfHw",
        authDomain: "mijnkookapp2.firebaseapp.com",
        projectId: "mijnkookapp2",
        storageBucket: "mijnkookapp2.firebasestorage.app",
        messagingSenderId: "77365526386",
        appId: "1:77365526386:web:faa6d99632dae10b4d67eb"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    let currentType = 'All';

    function getScoreStyles(score) {
        if (!score || score === 0) return { width: '5%', color: '#ddd', emoji: 'üò∂' };
        if (score < 1) return { width: '15%', color: '#ef4444', emoji: 'üí©' };
        if (score < 2) return { width: '30%', color: '#f97316', emoji: 'ü§¢' };
        if (score < 3) return { width: '50%', color: '#eab308', emoji: 'üòê' };
        if (score < 4) return { width: '75%', color: '#84cc16', emoji: 'üôÇ' };
        if (score < 5) return { width: '95%', color: '#10b981', emoji: 'üòã' };
        return { width: '100%', color: '#8b5cf6', emoji: 'üèÜ' };
    }

    const q = query(collection(db, "recepten"), orderBy("datum", "desc"));
    onSnapshot(q, (snapshot) => {
        const grid = document.getElementById('recipeGrid');
        grid.innerHTML = "";
        
        snapshot.forEach((doc) => {
            const r = doc.data();
            const scoreData = getScoreStyles(r.gemiddeldeScore || 0);
            const searchText = `${r.titel} ${r.chef} ${r.ingredienten}`.toLowerCase();

            grid.innerHTML += `
                <a href="recept.html?id=${doc.id}" 
                   class="recipe-card" 
                   data-search="${searchText}" 
                   data-type="${r.type}">
                    <img src="${r.foto || 'https://via.placeholder.com/400x300?text=Geen+Foto'}" class="card-img">
                    <div class="card-emoji">${scoreData.emoji}</div>
                    <div class="card-content">
                        <h2 class="card-title">${r.titel}</h2>
                        <div class="card-chef">üë®‚Äçüç≥ Chef ${r.chef} ‚Ä¢ ${r.type}</div>
                    </div>
                    <div class="score-bar-container">
                        <div class="score-bar-fill" style="width: ${scoreData.width}; background-color: ${scoreData.color};"></div>
                    </div>
                </a>
            `;
        });
        filterContent();
    });

    window.setFilter = (type, btn) => {
        currentType = type;
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        filterContent();
    };

    window.filterContent = () => {
        const term = document.getElementById('searchInput').value.toLowerCase();
        const cards = document.querySelectorAll('.recipe-card');
        
        cards.forEach(card => {
            const matchesSearch = card.getAttribute('data-search').includes(term);
            const matchesType = currentType === 'All' || card.getAttribute('data-type') === currentType;
            
            card.style.display = (matchesSearch && matchesType) ? "flex" : "none";
        });
    };
</script>
</body>
</html>
