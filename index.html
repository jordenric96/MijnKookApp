<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KookApp van Loemek</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
            --soft-bg: linear-gradient(135deg, #fce7f3 0%, #f5f3ff 100%);
        }
        body { font-family: 'Poppins', sans-serif; background: var(--soft-bg) no-repeat fixed; margin: 0; color: #374151; min-height: 100vh; }
        header { background: var(--primary-gradient); color: white; padding: 40px 20px; text-align: center; border-radius: 0 0 30px 30px; }
        header h1 { font-family: 'Playfair Display', serif; font-size: clamp(28px, 8vw, 45px); margin: 0; }
        
        .controls-container { max-width: 1000px; margin: -25px auto 20px; padding: 0 15px; }
        #searchInput { width: 100%; padding: 15px 20px; border-radius: 25px; border: none; box-shadow: 0 8px 20px rgba(0,0,0,0.1); outline: none; }

        .filter-tabs { display: flex; gap: 10px; margin-top: 20px; overflow-x: auto; padding-bottom: 10px; scrollbar-width: none; }
        .filter-tabs::-webkit-scrollbar { display: none; }
        .filter-btn { padding: 10px 18px; border-radius: 20px; border: none; background: white; color: #8b5cf6; font-weight: 600; cursor: pointer; white-space: nowrap; }
        .filter-btn.active { background: #ec4899; color: white; box-shadow: 0 6px 15px rgba(236, 72, 153, 0.3); }

        .recipe-grid { display: grid; grid-template-columns: 1fr; gap: 20px; max-width: 1200px; margin: 20px auto; padding: 0 15px 100px; }
        @media (min-width: 600px) { .recipe-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (min-width: 1000px) { .recipe-grid { grid-template-columns: repeat(3, 1fr); } }

        .recipe-card { background: white; border-radius: 25px; overflow: hidden; box-shadow: 0 8px 20px rgba(0,0,0,0.05); text-decoration: none; color: inherit; position: relative; display: flex; flex-direction: column; }
        .card-img { width: 100%; height: 200px; object-fit: cover; }
        .card-content { padding: 20px; }
        .card-title { font-family: 'Playfair Display', serif; font-size: 20px; margin: 0; }
        .card-tags { font-size: 11px; color: #ec4899; font-weight: 600; margin-top: 5px; }

        .score-badge { position: absolute; right: 15px; top: 175px; background: white; padding: 6px 12px; border-radius: 18px; display: flex; align-items: center; gap: 6px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); font-weight: 700; }
        .add-btn { position: fixed; bottom: 25px; right: 25px; background: var(--primary-gradient); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; text-decoration: none; box-shadow: 0 8px 20px rgba(236, 72, 153, 0.4); z-index: 1000; }
    </style>
</head>
<body>

<header><h1>KookApp van Loemek</h1></header>

<div class="controls-container">
    <input type="text" id="searchInput" placeholder="Zoek een recept..." onkeyup="filterContent()">
    <div class="filter-tabs">
        <button class="filter-btn active" onclick="setFilter('All', this)">Alles ü•ò</button>
        <button class="filter-btn" onclick="setFilter('Hapjes', this)">Hapjes</button>
        <button class="filter-btn" onclick="setFilter('Voorgerecht', this)">Voorgerecht</button>
        <button class="filter-btn" onclick="setFilter('Hoofdgerecht', this)">Hoofdgerecht</button>
        <button class="filter-btn" onclick="setFilter('Dessert', this)">Dessert</button>
        <button class="filter-btn" onclick="setFilter('Patisserie', this)">Patisserie</button>
        <button class="filter-btn" onclick="setFilter('Sauzen', this)">Sauzen</button>
        <button class="filter-btn" onclick="setFilter('Marinades', this)">Marinades</button>
    </div>
</div>

<div class="recipe-grid" id="recipeGrid"></div>
<a href="toevoegen.html" class="add-btn">+</a>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBzsxSTQKhhh8yKb4AFew7zQz26BMNKfHw",
        authDomain: "mijnkookapp2.firebaseapp.com",
        projectId: "mijnkookapp2",
        storageBucket: "mijnkookapp2.firebasestorage.app",
        messagingSenderId: "77365526386",
        appId: "1:77365526386:web:faa6d99632dae10b4d67eb"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    let currentType = 'All';

    function getEmoji(val) {
        if (!val || val === 0) return "üò∂";
        if (val < 1.0) return "üí©"; if (val < 3.0) return "üòê"; if (val < 4.0) return "üôÇ"; if (val < 5.0) return "üòã"; return "üèÜ";
    }

    const q = query(collection(db, "recepten"), orderBy("datum", "desc"));
    onSnapshot(q, (snapshot) => {
        const grid = document.getElementById('recipeGrid');
        grid.innerHTML = "";
        snapshot.forEach((doc) => {
            const r = doc.data();
            const score = r.gemiddeldeScore || 0;
            const themas = r.types ? r.types.join(', ') : (r.type || 'Geen');
            const searchData = `${r.titel} ${r.chef} ${themas}`.toLowerCase();

            grid.innerHTML += `
                <a href="recept.html?id=${doc.id}" class="recipe-card" data-search="${searchData}" data-types="${r.types ? r.types.join('|') : r.type}">
                    <img src="${r.foto || 'https://via.placeholder.com/400x300'}" class="card-img">
                    <div class="score-badge"><span>${getEmoji(score)}</span> <span>${score > 0 ? score : '-'}</span></div>
                    <div class="card-content">
                        <h2 class="card-title">${r.titel}</h2>
                        <div class="card-tags">üë®‚Äçüç≥ ${r.chef} ‚Ä¢ ${themas}</div>
                    </div>
                </a>`;
        });
        filterContent();
    });

    window.setFilter = (type, btn) => {
        currentType = type;
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        filterContent();
        btn.scrollIntoView({ behavior: 'smooth', inline: 'center' });
    };

    window.filterContent = () => {
        const term = document.getElementById('searchInput').value.toLowerCase();
        document.querySelectorAll('.recipe-card').forEach(card => {
            const matchesSearch = card.getAttribute('data-search').includes(term);
            const cardTypes = card.getAttribute('data-types').split('|');
            const matchesType = currentType === 'All' || cardTypes.includes(currentType);
            card.style.display = (matchesSearch && matchesType) ? "flex" : "none";
        });
    };
</script>
</body>
</html>

