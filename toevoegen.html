<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nieuw Recept - Loemek Kitchen</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background: linear-gradient(135deg, #fce7f3 0%, #f5f3ff 100%) no-repeat fixed; padding: 20px; color: #374151; }
        .form-container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        h2 { color: #8b5cf6; text-align: center; margin-bottom: 25px; }
        label { font-weight: 600; display: block; margin-top: 15px; color: #4b5563; }
        input, textarea { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #e5e7eb; border-radius: 12px; box-sizing: border-box; font-family: inherit; font-size: 14px; }
        
        .theme-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; background: #f9fafb; padding: 15px; border-radius: 15px; border: 1px solid #eee; }
        .theme-item { display: flex; align-items: center; gap: 10px; font-size: 14px; cursor: pointer; }
        .theme-item input { width: auto; margin: 0; accent-color: #8b5cf6; }

        .btn-submit { background: linear-gradient(135deg, #ec4899, #8b5cf6); color: white; border: none; padding: 16px; border-radius: 25px; width: 100%; font-weight: 600; margin-top: 30px; cursor: pointer; font-size: 16px; transition: 0.3s; }
        .btn-submit:active { transform: scale(0.98); }
    </style>
</head>
<body>

<div class="form-container">
    <h2>Nieuw Recept ‚úçÔ∏è</h2>
    <form id="recipeForm">
        <label>Titel van het gerecht</label>
        <input type="text" id="titel" placeholder="Bijv. Bresiliennetaart" required>

        <label>Wie is de Chef?</label>
        <input type="text" id="chef" placeholder="Jouw naam" required>

        <label>Thema's (selecteer meerdere mogelijk)</label>
        <div class="theme-grid" id="themeGrid">
            <label class="theme-item"><input type="checkbox" value="Hapjes"> Hapjes</label>
            <label class="theme-item"><input type="checkbox" value="Voorgerecht"> Voorgerecht</label>
            <label class="theme-item"><input type="checkbox" value="Hoofdgerecht"> Hoofdgerecht</label>
            <label class="theme-item"><input type="checkbox" value="Dessert"> Dessert</label>
            <label class="theme-item"><input type="checkbox" value="Patisserie"> Patisserie</label>
            <label class="theme-item"><input type="checkbox" value="Sauzen"> Sauzen</label>
            <label class="theme-item"><input type="checkbox" value="Marinades"> Marinades</label>
            <label class="theme-item"><input type="checkbox" value="Snack"> Snack</label>
        </div>

        <label>Aantal personen (basis)</label>
        <input type="number" id="personen" value="4">

        <label>Ingredi√´nten (per lijn, titels tussen haakjes)</label>
        <textarea id="ingredienten" rows="6" placeholder="(Deeg)&#10;1 rol kruimeldeeg&#10;(Vulling)&#10;500ml melk" required></textarea>

        <label>Bereidingswijze (gebruik getallen + min/minuten voor timers)</label>
        <textarea id="bereiding" rows="8" placeholder="Bak 20 minuten op 200 graden..." required></textarea>

        <label>Foto URL</label>
        <input type="url" id="foto" placeholder="https://link-naar-foto.jpg">

        <button type="submit" class="btn-submit">Recept Delen üöÄ</button>
        <a href="index.html" style="display:block; text-align:center; margin-top:15px; color:#9ca3af; text-decoration:none; font-size:14px;">Terug naar overzicht</a>
    </form>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBzsxSTQKhhh8yKb4AFew7zQz26BMNKfHw",
        authDomain: "mijnkookapp2.firebaseapp.com",
        projectId: "mijnkookapp2",
        storageBucket: "mijnkookapp2.firebasestorage.app",
        messagingSenderId: "77365526386",
        appId: "1:77365526386:web:faa6d99632dae10b4d67eb"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    document.getElementById('recipeForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Haal geselecteerde thema's op
        const geselecteerdeThemas = [];
        document.querySelectorAll('#themeGrid input:checked').forEach(cb => geselecteerdeThemas.push(cb.value));

        if (geselecteerdeThemas.length === 0) {
            alert("Kies aub minstens √©√©n thema.");
            return;
        }

        const nieuwRecept = {
            titel: document.getElementById('titel').value.trim(),
            chef: document.getElementById('chef').value.trim(),
            types: geselecteerdeThemas,
            personen: document.getElementById('personen').value,
            // We zorgen dat witruimte en nieuwe regels behouden blijven
            ingredienten: document.getElementById('ingredienten').value.trim(),
            bereiding: document.getElementById('bereiding').value.trim(),
            foto: document.getElementById('foto').value.trim(),
            datum: new Date(),
            gemiddeldeScore: 0,
            totaalScores: 0,
            aantalStemmen: 0
        };

        try {
            await addDoc(collection(db, "recepten"), nieuwRecept);
            alert("Recept succesvol toegevoegd! ‚ú®");
            window.location.href = "index.html";
        } catch (error) {
            console.error("Fout:", error);
            alert("Er ging iets mis bij het opslaan.");
        }
    });
</script>
</body>
</html>
